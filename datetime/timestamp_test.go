package datetime

import (
	"testing"
)

func TestAnyToTimestamp(t *testing.T) {
	data := []string{
		"Mar-24",
		"3/1/24 00:00",
		"45352",
		"20151",
		"201501",
		"2015-1",
		"2015/1",
		"2015.1",
		"2015-01",
		"2015/01",
		"2015.01",
		"2015年1月",
		"20150102",
		"2015-01-02",
		"2015/01/02",
		"2015.01.02",
		"2015/1/2",
		"2015-1-2",
		"2015.1.2",
		"01-02-06",
		"1-2-06",
		"2015年1月2号",
		"2015年01月02号",
		"2015年01月2号",
		"2015年1月02号",
		"2015年1月2日",
		"2015年01月02日",
		"2015年01月2日",
		"2015年1月02日",
		"2015",
		"2015-01",
		"2015-01-02",
		"2015-01-02 15",
		"2015-01-02 15:04",
		"2015-01-02 15:04:05",
		"2015/01",
		"2015/01/02",
		"2015/01/02 15",
		"2015/01/02 15:04",
		"2015/01/02 15:04:05",
		"2015.01",
		"2015.01.02",
		"2015.01.02 15",
		"2015.01.02 15:04",
		"2015.01.02 15:04:05",
		"201501",
		"20150102",
		"20150102 15",
		"20150102 15:04",
		"20150102 15:04:05",
		"2015年",
		"2015年01月",
		"2015年01月02日",
		"2015年01月02日 15时",
		"2015年01月02日 15时04分",
		"2015年01月02日 15时04分05秒",
		"03-01-24",
	}
	for _, v := range data {
		val := AnyToTimestamp(v)
		if val <= 0 {
			t.Logf("失败：%s %d", v, val)
		} else {
			t.Logf("成功：%s %s %d", v, TimestampToDate(val, YYYYMMDD_HHMMSS_0), val)
		}
	}
}

func TestExcelDateToTime(t *testing.T) {
	// 45352 = 2024年3月1日
	ts, err := ExcelDateToTime("45352")
	if err != nil {
		t.Log(err)
		return
	}
	t.Log(ts.Unix())
}
